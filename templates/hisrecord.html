<script src="/static/bootstrap_datepicker/js/bootstrap-datepicker.js"></script>
<link rel="stylesheet" type="text/css" href="/static/bootstrap_datepicker/css/bootstrap-datepicker.css" />

<div class="box">
    <div class="box-header">
		<h3 class="box-title">选取时间段</h3>
	</div>
    <div class="box-body">
        <div class="input-group input-daterange col-md-3">
            <input type="text" class="form-control" id="starttime" />
            <span class="input-group-addon">to</span>
            <input type="text" class="form-control" id="endtime" />
        </div>
    </div>
	<div class="box-header">
		<h3 class="box-title">查询IP</h3>
	</div>
	<div class="box-body">
		<div class="col-md-2">
			<input type="text" class="form-control" id="checkip" >
		</div>
		<div class="col-md-2">
			<button class="btn btn-info btn-sm" id="checkrecord">查询</button>
		</div>
	</div>
</div>
<div id="recordInfo">
    <table class="table table-bordered table-striped" id="recordTable">
        <thead>
            <tr>
                <th>IP</th>
                <th>查询时间</th>
                <th>报告链接</th>
            </tr>
        </thead>
        <tbody>
            {% for record in records %}
                <tr>
                    <td>{{ record.ip }}</td>
                    <td>{{ record.time|date:"Y-m-d H:i:s" }}</td>
                    <td>{{ record.url }}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<script>
    //控制<请稍等>
    $("#loadingwait").hide();

    //日期插件
    $('.input-daterange input').each(function() {
        $(this).datepicker('clearDates');
    })

	//提交查询
	$("#checkrecord").on("click",function(){
		//获取输入的IP
		checkip = $("#checkip").val().trim();
        //获取输入的时间
        starttime = $("#starttime").val().trim();
        endtime = $("#endtime").val().trim();
        if (checkip == ""){
		    alert("请输入查询机器IP")
        }else {
		    url = "/checkhis?checkip="+checkip;
            $("#loadingwait").show();
            $("#info").load(url)
        }
	})
</script>